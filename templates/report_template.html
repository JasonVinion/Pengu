<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pengu Network Tools - Scan Report</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f5f5f5;
            color: #333;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }
        
        .header h1 {
            margin: 0;
            font-size: 2.5em;
            font-weight: 300;
        }
        
        .header .subtitle {
            margin: 10px 0 0 0;
            opacity: 0.9;
            font-size: 1.1em;
        }
        
        .meta-info {
            background-color: #f8f9fa;
            padding: 20px;
            border-bottom: 1px solid #e9ecef;
        }
        
        .meta-info table {
            width: 100%;
            border-collapse: collapse;
        }
        
        .meta-info td {
            padding: 8px;
            border-bottom: 1px solid #dee2e6;
        }
        
        .meta-info td:first-child {
            font-weight: bold;
            width: 150px;
            color: #495057;
        }
        
        .content {
            padding: 30px;
        }
        
        .section {
            margin-bottom: 40px;
        }
        
        .section h2 {
            color: #495057;
            border-bottom: 3px solid #667eea;
            padding-bottom: 10px;
            margin-bottom: 20px;
        }
        
        .results-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .result-card {
            border: 1px solid #e9ecef;
            border-radius: 6px;
            padding: 20px;
            background-color: #fff;
        }
        
        .result-card h3 {
            margin: 0 0 15px 0;
            color: #495057;
            font-size: 1.2em;
        }
        
        .port-list {
            list-style: none;
            padding: 0;
            margin: 0;
        }
        
        .port-item {
            padding: 8px 12px;
            margin: 5px 0;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
        }
        
        .port-open {
            background-color: #d4edda;
            color: #155724;
            border-left: 4px solid #28a745;
        }
        
        .port-closed {
            background-color: #f8d7da;
            color: #721c24;
            border-left: 4px solid #dc3545;
        }
        
        .subdomain-list {
            background-color: #f8f9fa;
            padding: 15px;
            border-radius: 4px;
            margin: 10px 0;
        }
        
        .subdomain-item {
            padding: 5px 0;
            border-bottom: 1px solid #e9ecef;
            font-family: 'Courier New', monospace;
        }
        
        .subdomain-item:last-child {
            border-bottom: none;
        }
        
        .dns-record {
            background-color: #e7f3ff;
            padding: 10px;
            margin: 5px 0;
            border-radius: 4px;
            border-left: 4px solid #007bff;
        }
        
        .dns-record-type {
            font-weight: bold;
            color: #007bff;
        }
        
        .summary-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }
        
        .stat-card {
            text-align: center;
            padding: 20px;
            border-radius: 6px;
            color: white;
        }
        
        .stat-card.hosts {
            background: linear-gradient(135deg, #ff7b7b, #667eea);
        }
        
        .stat-card.ports {
            background: linear-gradient(135deg, #4ecdc4, #44a08d);
        }
        
        .stat-card.services {
            background: linear-gradient(135deg, #ffeaa7, #fab1a0);
            color: #2d3436;
        }
        
        .stat-card.vulns {
            background: linear-gradient(135deg, #fd79a8, #fdcb6e);
        }
        
        .stat-number {
            font-size: 2.5em;
            font-weight: bold;
            margin: 0;
        }
        
        .stat-label {
            margin: 5px 0 0 0;
            opacity: 0.9;
        }
        
        .footer {
            background-color: #495057;
            color: white;
            text-align: center;
            padding: 20px;
            margin-top: 40px;
        }
        
        .warning {
            background-color: #fff3cd;
            border: 1px solid #ffeaa7;
            color: #856404;
            padding: 15px;
            border-radius: 4px;
            margin: 20px 0;
        }
        
        .success {
            background-color: #d4edda;
            border: 1px solid #c3e6cb;
            color: #155724;
            padding: 15px;
            border-radius: 4px;
            margin: 20px 0;
        }
        
        @media print {
            body { background-color: white; }
            .container { box-shadow: none; }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üêß Pengu Network Tools</h1>
            <div class="subtitle">Comprehensive Network Security Assessment Report</div>
        </div>
        
        <div class="meta-info">
            <table>
                <tr>
                    <td>Report Generated:</td>
                    <td>{{ generated_at.strftime('%Y-%m-%d %H:%M:%S UTC') }}</td>
                </tr>
                <tr>
                    <td>Tool Version:</td>
                    <td>{{ tool_version }}</td>
                </tr>
                <tr>
                    <td>Scan Target:</td>
                    <td>{{ scan_target }}</td>
                </tr>
                <tr>
                    <td>Scan Duration:</td>
                    <td>{{ scan_duration }} seconds</td>
                </tr>
                <tr>
                    <td>Scan Types:</td>
                    <td>{{ scan_types|join(', ') }}</td>
                </tr>
            </table>
        </div>
        
        <div class="content">
            <!-- Summary Statistics -->
            <div class="section">
                <h2>üìä Scan Summary</h2>
                <div class="summary-stats">
                    <div class="stat-card hosts">
                        <div class="stat-number">{{ summary.hosts_scanned }}</div>
                        <div class="stat-label">Hosts Scanned</div>
                    </div>
                    <div class="stat-card ports">
                        <div class="stat-number">{{ summary.ports_open }}</div>
                        <div class="stat-label">Open Ports</div>
                    </div>
                    <div class="stat-card services">
                        <div class="stat-number">{{ summary.services_identified }}</div>
                        <div class="stat-label">Services Identified</div>
                    </div>
                    <div class="stat-card vulns">
                        <div class="stat-number">{{ summary.security_issues }}</div>
                        <div class="stat-label">Security Issues</div>
                    </div>
                </div>
            </div>
            
            <!-- Port Scan Results -->
            {% if results.port_scan %}
            <div class="section">
                <h2>üîç Port Scan Results</h2>
                <div class="results-grid">
                    {% for host, ports in results.port_scan.items() %}
                    <div class="result-card">
                        <h3>{{ host }}</h3>
                        <ul class="port-list">
                            {% for port in ports %}
                            <li class="port-item {{ 'port-open' if port.status == 'open' else 'port-closed' }}">
                                Port {{ port.number }}/{{ port.protocol }} - {{ port.service|default('Unknown') }}
                                {% if port.version %}
                                <br><small>Version: {{ port.version }}</small>
                                {% endif %}
                            </li>
                            {% endfor %}
                        </ul>
                    </div>
                    {% endfor %}
                </div>
            </div>
            {% endif %}
            
            <!-- DNS Enumeration Results -->
            {% if results.dns_enum %}
            <div class="section">
                <h2>üåê DNS Enumeration Results</h2>
                
                {% if results.dns_enum.subdomains %}
                <h3>Discovered Subdomains</h3>
                <div class="subdomain-list">
                    {% for subdomain in results.dns_enum.subdomains %}
                    <div class="subdomain-item">
                        <strong>{{ subdomain.name }}</strong> ‚Üí {{ subdomain.ips|join(', ') }}
                    </div>
                    {% endfor %}
                </div>
                {% endif %}
                
                {% if results.dns_enum.records %}
                <h3>DNS Records</h3>
                {% for record_type, records in results.dns_enum.records.items() %}
                <div class="dns-record">
                    <span class="dns-record-type">{{ record_type }}:</span>
                    {% for record in records %}
                    <div>{{ record }}</div>
                    {% endfor %}
                </div>
                {% endfor %}
                {% endif %}
            </div>
            {% endif %}
            
            <!-- SSL/TLS Analysis -->
            {% if results.ssl_analysis %}
            <div class="section">
                <h2>üîí SSL/TLS Certificate Analysis</h2>
                {% for host, ssl_info in results.ssl_analysis.items() %}
                <div class="result-card">
                    <h3>{{ host }}</h3>
                    {% if ssl_info.error %}
                    <div class="warning">
                        <strong>Error:</strong> {{ ssl_info.error }}
                    </div>
                    {% else %}
                    <table style="width: 100%; border-collapse: collapse;">
                        <tr><td><strong>Subject:</strong></td><td>{{ ssl_info.subject }}</td></tr>
                        <tr><td><strong>Issuer:</strong></td><td>{{ ssl_info.issuer }}</td></tr>
                        <tr><td><strong>Valid From:</strong></td><td>{{ ssl_info.valid_from }}</td></tr>
                        <tr><td><strong>Valid Until:</strong></td><td>{{ ssl_info.valid_until }}</td></tr>
                        <tr><td><strong>Protocol:</strong></td><td>{{ ssl_info.protocol }}</td></tr>
                        <tr><td><strong>Security Rating:</strong></td><td>{{ ssl_info.security_rating }}/100</td></tr>
                    </table>
                    
                    {% if ssl_info.expired %}
                    <div class="warning">
                        <strong>‚ö†Ô∏è Warning:</strong> Certificate has expired!
                    </div>
                    {% endif %}
                    {% endif %}
                </div>
                {% endfor %}
            </div>
            {% endif %}
            
            <!-- Security Recommendations -->
            {% if recommendations %}
            <div class="section">
                <h2>üí° Security Recommendations</h2>
                {% for recommendation in recommendations %}
                <div class="warning">
                    <strong>{{ recommendation.severity }}:</strong> {{ recommendation.description }}
                    {% if recommendation.remediation %}
                    <br><small><strong>Remediation:</strong> {{ recommendation.remediation }}</small>
                    {% endif %}
                </div>
                {% endfor %}
            </div>
            {% endif %}
            
            <!-- Disclaimer -->
            <div class="section">
                <div class="warning">
                    <strong>‚ö†Ô∏è Disclaimer:</strong> This report is generated by automated security scanning tools. 
                    Results should be verified manually and used responsibly. The scan results may contain 
                    false positives or miss certain vulnerabilities. Always ensure you have proper authorization 
                    before scanning network resources.
                </div>
            </div>
        </div>
        
        <div class="footer">
            <p>Generated by Pengu Network Tools | 
            <a href="https://github.com/JasonVinion/Pengu" style="color: #b3d4fc;">GitHub Repository</a></p>
            <p><small>Use these tools responsibly and only on networks you own or have explicit permission to test.</small></p>
        </div>
    </div>
</body>
</html>